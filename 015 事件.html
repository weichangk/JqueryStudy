<!DOCTYPE html>
<!--
1. 页面载入
    1.1 ready(fn)
        当DOM载入就绪可以查询及操纵时绑定一个要执行的函数。
        这是事件模块中最重要的一个函数，因为它可以极大地提高web应用程序的响应速度。
        简单地说，这个方法纯粹是对向window.load事件注册事件的替代方法。通过使用这个方法，可以在DOM载入就绪能够读取并操纵时立即调用你所绑定的函数，而99.99%的JavaScript函数都需要在那一刻执行。

        jquery 入口函数和 window.onload 的区别
        1. jquery 入口函数可以多个；window.onload 只能一个。
        2. 执行顺序不同。
        jquery 入口函数要等待页面上的dom树加载完成后执行
        window.onload 要等待所有资源都加载完成才执行
        jQ3 之前 jquery 入口函数比 window.onload 先执行
        jQ3 对于图片、超链接等加载资源少的情况下，只有文本之类的情况下会出现 window.onload 比 jquery 入口函数先执行。

2. 事件处理
    2.1 on(events,[selector],[data],fn)             将一个或多个事件的事件处理函数附加到选定元素。
    2.2 off(events,[selector],[fn])                 在选择元素上移除一个或多个事件的事件处理函数。
    2.3 bind(type,[data],fn)                        为每个匹配元素的特定事件绑定事件处理函数。jQuery 3.0中已弃用此方法，请用 on()代替。
    2.4 unbind(type,[data|fn]])                     bind()的反向操作，从每一个匹配的元素中删除绑定的事件。jQuery 3.0中已弃用此方法，请用 off()代替。
    2.5 one(type,[data],fn)                         为每一个匹配元素的特定事件（像click）绑定一个一次性的事件处理函数。        
    2.6 trigger(type,[data])                        在每一个匹配的元素上触发某类事件。
    2.7 triggerHandler(type, [data])                触发指定的事件类型上所有绑定的处理函数。但不会执行浏览器默认动作，也不会产生事件冒泡。

3. 事件委托
    3.1 live(type, [data], fn)                      所有匹配的元素附加一个事件处理函数，即使这个元素是以后再添加进来的也有效。从 jQuery 1.7 开始，不再建议使用 .live() 方法。请使用 .on() 来添加事件处理。使用旧版本的用户，应该优先使用 .delegate() 来替代 .live()。
    3.2 die(type, [fn])                             从元素中删除先前用.live()绑定的所有事件.(此方法与live正好完全相反。)
    3.3 delegate(selector,[type],[data],fn)         指定的元素（属于被选元素的子元素）添加一个或多个事件处理程序，并规定当这些事件发生时运行的函数。jQuery 3.0中已弃用此方法，请用 on()代替。
    3.4 undelegate([selector,[type],fn])            删除由 delegate() 方法添加的一个或多个事件处理程序。jQuery 3.0中已弃用此方法，请用 off()代替。

4. 事件切换
    4.1 hover([over,]out)                           将一个或两个处理程序绑定到匹配的元素，当鼠标指针进入和离开元素时执行。
    4.2 toggle([speed],[easing],[fn])               将两个或更多的处理程序绑定到匹配的元素，以便在每次单击时执行。如果元素是可见的，切换为隐藏的；如果元素是隐藏的，切换为可见的。

5. 其他事件
    5.1 blur([[data],fn])                           将事件处理程序绑定到“blur”事件，可在元素上触发该事件。
    5.2 change([[data],fn])                         当元素的值发生改变时，会发生 change 事件。
    5.5 error([[data],fn])                          当元素遇到错误时（当元素没有正确载入时），发生 error 事件。在 jQuery 版本 1.8 中被废弃。
    5.6 focus([[data],fn])                          当元素获得焦点时，触发 focus 事件。
    5.7 focusin([data],fn)                          当元素获得焦点时，触发 focusin 事件。focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。
    5.8 focusout([data],fn)                         当元素失去焦点时触发 focusout 事件。focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。
    5.9 keydown([[data],fn])                        当键盘或按钮被按下时，发生 keydown 事件。如果在文档元素上进行设置，则无论元素是否获得焦点，该事件都会发生。
    5.10 keypress([[data],fn])                      keypress 事件与 keydown 事件类似。当按钮被按下时发生该事件。然而，keypress 事件不会触发所有的键（比如 ALT、CTRL、SHIFT、ESC）。请使用 keydown() 方法来检查这些键。
    5.11 keyup([[data],fn])                         当按钮被松开时，发生 keyup 事件。它发生在当前获得焦点的元素上。如果在文档元素上进行设置，则无论元素是否获得焦点，该事件都会发生。
    5.12 mousedown([[data],fn])                     当鼠标指针移动到元素上方，并按下鼠标按键时，会发生 mousedown 事件。
    5.13 mouseup([[data],fn])                       当在元素上放松鼠标按钮时，会发生 mouseup 事件。与 click 事件不同，mouseup 事件仅需要放松按钮。当鼠标指针位于元素上方时，放松鼠标按钮就会触发该事件。
    5.14 mouseenter([[data],fn])                    当鼠标指针穿过元素时，会发生 mouseenter 事件。该事件大多数时候会与mouseleave 事件一起使用。
    5.15 mouseleave([[data],fn])                    当鼠标指针离开元素时，会发生 mouseleave 事件。该事件大多数时候会与mouseenter 事件一起使用。
    5.16 mousemove([[data],fn])                     当鼠标指针在指定的元素中移动时，就会发生 mousemove 事件。
    5.17 mouseover([[data],fn])                     当鼠标指针位于元素上方时，会发生 mouseover 事件。该事件大多数时候会与 mouseout 事件一起使用。与 mouseenter 事件不同，不论鼠标指针穿过被选元素或其子元素，都会触发 mouseover 事件。只有在鼠标指针穿过被选元素时，才会触发 mouseenter 事件
    5.18 mouseout([[data],fn])                      当鼠标指针从元素上移开时，发生 mouseout 事件。该事件大多数时候会与 mouseover 事件一起使用。与 mouseleave 事件不同，mouseout 事件在鼠标指针离开被选元素或任意子元素时都会被触发，mouseleave 事件只有在鼠标指针离开被选元素时被触发
    5.19 resize([[data],fn])                        当调整浏览器窗口的大小时，发生 resize 事件。
    5.20 scroll([[data],fn])                        当用户滚动指定的元素时，会发生 scroll 事件。scroll 事件适用于所有可滚动的元素和 window 对象（浏览器窗口）。
    5.21 select([[data],fn])                        当 textarea 或文本类型的 input 元素中的文本被选择时，会发生 select 事件。
    5.21 submit([[data],fn])                        当提交表单时，会发生 submit 事件。该事件只适用于表单元素。


-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>2.1 on(events,[selector],[data],fn)             将一个或多个事件的事件处理函数附加到选定元素。</h1>
    <div id="onTest">
        <p class="p1">p1</p>
        <p class="p2">p2</p>
        <span class="sp1">
            span1
            <button class="b1">sp1 按钮1</button>
            <button class="b2">sp1 按钮2</button>
        </span>
        <form class="f1" action="http://www.baidu.com">
            <input type="submit" value="f1 提交">
        </form>
        <form class="f2" action="http://cn.bing.com">
            <input type="submit" value="f2 提交">
        </form>
    </div>
    <hr>
<!---->
    <h1>2.2 off(events,[selector],[fn])                 在选择元素上移除一个或多个事件的事件处理函数。</h1>
    <div id="offTest">
        <button id="theone" style="color: red; background: yellow;">Does nothing...</button>
        <button id="bind">Add Click</button>
        <button id="unbind">Remove Click</button>
        <div style="display:none;">Click!</div>
        <p class="p1">p1</p>
    </div>
    <hr>
<!---->
    <h1>2.3 bind(type,[data],fn)                        为每个匹配元素的特定事件绑定事件处理函数。jQuery 3.0中已弃用此方法，请用 on()代替。</h1>
    <div>

    </div>
    <hr>
<!---->
    <h1>2.5 one(type,[data],fn)                         为每一个匹配元素的特定事件（像click）绑定一个一次性的事件处理函数。</h1>
    <div id="oneTest">
        <p>oneTest p</p>
    </div>
    <hr>
<!---->
    <h1>2.6 trigger(type,[data])                        在每一个匹配的元素上触发某类事件。</h1>
    <div id="triggerTest">
        <button>triggerTest b1</button>
        <button>triggerTest b2</button>
        <div><span>0</span> button #1 clicks.</div>
        <div><span>0</span> button #2 clicks.</div>
        <p class="p1">triggerTest p1</p>
        <p class="p2">triggerTest p2</p>
    </div>
    <hr>
<!---->
    <h1>2.7 triggerHandler(type, [data])                触发指定的事件类型上所有绑定的处理函数。但不会执行浏览器默认动作，也不会产生事件冒泡。</h1>
    <div id="triggerHandlerTest">
        <button class="b1">triggerTest btn</button>
        <button class="b2">triggerHandlerTest btn</button><br>
        <input type="text" value="to be focused">
        <span></span>
    </div>
    <hr>
<!---->
    <h1>4.1 hover([over,]out)                           将一个或两个处理程序绑定到匹配的元素，当鼠标指针进入和离开元素时执行。</h1>
    <div id="hoverTest">
        <ul class="ul1">
            <li>html</li>
            <li>css</li>
            <li class="fade">javaScript</li>
            <li class="fade">jQuery</li>
        </ul>
    </div>
    <hr>
<!---->
    <h1>4.2 toggle([speed],[easing],[fn])               将两个或更多的处理程序绑定到匹配的元素，以便在每次单击时执行。如果元素是可见的，切换为隐藏的；如果元素是隐藏的，切换为可见的。</h1>
    <div id="toggleTest">
        <p class="p1">hello toggle()</p>
        <p class="p1" style="display: none;">hello toggle() !!!</p>
        <button class="b1">切换显示</button>
        <p class="p2">p2p2</p>
    </div>
    <hr>
<!---->
    <h1>5.1 blur([[data],fn])                           将事件处理程序绑定到“blur”事件，可在元素上触发该事件。</h1>
    <div id="blurTest">
        <p>hello blur</p>
        <button>按钮</button>
    </div>
    <hr>
<!---->
    <h1>5.2 change([[data],fn])                         当元素的值发生改变时，会发生 change 事件。</h1>
    <div id="changeTest">
        <select name="" id="" multiple = "multiple">
            <option value="html">html</option>
            <option value="css">css</option>
            <option value="javaScript">javaScript</option>
            <option value="jQuery">jQuery</option>
        </select>
        <div></div>
        <input type="text" name="" id="">
    </div>
    <hr>
<!---->
    <h1>5.5 error([[data],fn])                          当元素遇到错误时（当元素没有正确载入时），发生 error 事件。在 jQuery 版本 1.8 中被废弃。</h1>
    <div id="errorTest">
        <img src="" alt="....">
    </div>
    <hr>
<!---->
    <h1>5.6 focus([[data],fn])                          当元素获得焦点时，触发 focus 事件。</h1>
    <div id="focusTest">
        <p><input type="text"><span style="display: none;">focus fire</span></p>
        <p><input type="password" name="" id=""><span style="display: none;">focus fire</span></p>
    </div>
    <hr>
<!---->
    <h1>5.7 focusin([data],fn)                          当元素获得焦点时，触发 focusin 事件。focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。</h1>
    <div id="focusinTest">
        <p><input type="text"><span style="display: none;">focusin fire</span></p>
        <p><input type="password" name="" id=""><span style="display: none;">focusin fire</span></p>
    </div>
    <hr>
<!---->
    <h1>5.8 focusout([data],fn)                         当元素失去焦点时触发 focusout 事件。focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。</h1>
    <div id="focusoutTest">
        <p>
            <input type="text"><span id="focusoutSp1">focusout fire</span><br>
            <input type="text"><span id="focusoutSp2">blur fire</span>
        </p>
        <p>
            <input type="password" name="" id="">
        </p>
    </div>
    <hr>
<!---->
    <h1>5.9 keydown([[data],fn])                        当键盘或按钮被按下时，发生 keydown 事件。</h1>
    <div id="keydownTest">
        <label for="target">Type Something:</label>
        <input type="text" name="" id="target">
        <button>Trigger the handler</button>
    </div>
    <hr>
<!---->
    <h1>5.12 鼠标相关事件。</h1>
    <div id="mousedownTest"> 
        <p class="mousedown">mousedown 事件测试</p>
        <p class="mouseenter">mouseenter 事件测试</p>
        <p class="mousemove">mousemove 事件测试</p>
        <div class="mouseover" style="height: 200px; background-color: antiquewhite;">
            <p>mouseover 事件测试</p>
        </div>
    </div>
    <hr>
<!---->
    <h1>select([[data],fn])                        当 textarea 或文本类型的 input 元素中的文本被选择时，会发生 select 事件。</h1>
    <div id="selectTest">
        <input type="text" value="select">
    </div>
    <hr>
<!---->
    <h1>submit([[data],fn])                        当提交表单时，会发生 submit 事件。该事件只适用于表单元素。</h1>
    <form id="submitTest" action="http://www.baidu.com">
        请输入：
        <input type="text" name="text" value="correct">
        <span></span>
        <input type="submit" value="提交">
        <input type="reset" value="重置">
    </form> 
</body>
</html>
<script src="js/jquery-3.6.0.js"></script>
<script>
    // 1. 页面载入
    $(document).ready(function(){
        console.log("$(document).ready(function()");
    })

    $(function($){
        console.log($);
    })

    $(function(){
        console.log("$(function()");
    })

    // 2. 事件处理
    // 2.1 on(events,[selector],[data],fn)             将一个或多个事件的事件处理函数附加到选定元素。
    $("#onTest p.p1").on("click", function(){//绑定事件
        console.log($(this).text());
    })

    $("#onTest p.p2").on("click", {foo: "bar"}, p2Handler);//将数据传递给事件处理程序
    function p2Handler(event){
        console.log(event.data.foo);
    }

    $("#onTest span.sp1").on("click", function(){
        console.log("#onTest span.sp1 click");
    })
    $("#onTest span.sp1 button.b1").on("click", function(){
        console.log("#onTest span.sp1 button.b1 click");//冒泡
    })
    $("#onTest span.sp1 button.b2").on("click", function(event){
        event.stopPropagation();//阻止冒泡
        console.log("#onTest span.sp1 button.b2 click");
    })

    $("#onTest form.f1").on("submit", false);//取消表单提交操作，并通过返回false防止事件冒泡

    $("#onTest form.f2").on("submit", function(event){
        event.preventDefault();//取消默认操作
        console.log("#onTest form.f2 event.preventDefault()");
    })

    // 2.2 off(events,[selector],[fn])                 在选择元素上移除一个或多个事件的事件处理函数。
    function offTest_flash() {
        $("#offTest div").show().fadeOut("slow");
    }
    $("#bind").click(function(){
        $("#offTest").on("click", "#theone", offTest_flash).find("#theone").text("Can Click!");
    })
    $("#unbind").click(function(){
        $("#offTest").off("click", "#theone", offTest_flash).find("#theone").text("Does nothing...");
    })
    function offTest_foo(){
        console.log("offTest_foo");
        $("#offTest p.p1").off("click", offTest_foo);//只触发一次点击事件
    }
    $("#offTest p.p1").on("click", offTest_foo);

    // 2.5 one(type,[data],fn)                         为每一个匹配元素的特定事件（像click）绑定一个一次性的事件处理函数。
    $("#oneTest p").one("click", function(){
        console.log("one(type,[data],fn)");
    })

    // 2.6 trigger(type,[data])                        在每一个匹配的元素上触发某类事件。
    $("#triggerTest button").first().click(function(){
        update($("#triggerTest span").first()); 
    })
    $("#triggerTest button").last().click(function(){
        update($("#triggerTest span").last());
        $("#triggerTest button").first().trigger("click");//最后一个按钮点击触发第一个按钮点击事件
    })
    function update(j){
        var n = parseInt(j.text(), 10);
        j.text(n+1);
    }

    $("#triggerTest p.p1").click(function(event, a, b){
        console.log("#triggerTest p.p1 click:" + a + "    " + b);//手动点击不会执行触发传参，a和b都是undefined
    })
    $("#triggerTest p.p2").click(function(){
        console.log("#triggerTest p.p2 click" );
        $("#triggerTest p.p1").trigger("click", [ "trigger: foo1", "bar1" ]);//触发p1点击事件。并将通过触发器参数传参到p1点击事件上
    })

    // 2.7 triggerHandler(type, [data])                触发指定的事件类型上所有绑定的处理函数。但不会执行浏览器默认动作，也不会产生事件冒泡。
    $("#triggerHandlerTest input").focus(function(){
        $("<span>focused!</span>").appendTo("#triggerHandlerTest span").fadeOut(1000);
    })
    $("#triggerHandlerTest button.b1").click(function(){
        $("#triggerHandlerTest input").trigger("focus");
    })
    $("#triggerHandlerTest button.b2").click(function(){
        $("#triggerHandlerTest input").triggerHandler("focus");//触发绑定在input的focus处理函数，但是input不会执行浏览器默认动作得到焦点。
    })

    // 4. 事件切换
    // 4.1 hover([over,]out)                           将一个或两个处理程序绑定到匹配的元素，当鼠标指针进入和离开元素时执行。
    $("#hoverTest ul.ul1 li").hover(
        function(){
            $(this).append($("<span>***</span>"));
        },
        function(){
            $(this).find("span").last().remove();
        }
    )
    $("#hoverTest ul.ul1 li.fade").hover(
        function(){
            $(this).fadeOut(100);
        },
        function(){
            $(this).fadeIn(500);
        }
    )

    // 4.2 toggle([speed],[easing],[fn])               将两个或更多的处理程序绑定到匹配的元素，以便在每次单击时执行。如果元素是可见的，切换为隐藏的；如果元素是隐藏的，切换为可见的。
    $("#toggleTest button.b1").click(function(){
        $("#toggleTest p.p1").toggle();//如果元素是可见的，切换为隐藏的；如果元素是隐藏的，切换为可见的。
    })
    $("#toggleTest p.p2").click(function(){
        $("#toggleTest p.p2").toggle(
            function(){
                console.log("11111111111");
            },
            function(){
                console.log("22222222222");//只执行了最后一个事件处理方法，且元素隐藏状态切换了！！！！！！没有实现反复单击元素时，消息会交替出现。
            }
        )
    })

    // 5. 其他事件
    // 5.1 blur([[data],fn])                           将事件处理程序绑定到“blur”事件，可在元素上触发该事件。
    $("#blurTest p").blur(function(){
        console.log("hello blur")
    })
    $("#blurTest button").click(function(){
        $("#blurTest p").blur();//触发blur事件。
    })

    // 5.2 change([[data],fn])                         当元素的值发生改变时，会发生 change 事件。
    $("#changeTest select").change(function(){
        var str = "";
        $("select option:selected").each(function(){
            str += $(this).text() + " ";
        });
        $("#changeTest div").text(str);
    })
    $("#changeTest input[type='text']").change(function(){
        console.log($(this).val());//input[type='text']文本发生改变时，失去焦点或按enter键会触发change事件
    })

    // 5.5 error([[data],fn])                          当元素遇到错误时（当元素没有正确载入时），发生 error 事件。在 jQuery 版本 1.8 中被废弃。
    // $("#errorTest img").error(function(){
    //     $(this).replaceWith("<p>图片加载错误!</p>");//$(...).error is not a function
    // })

    // 5.6 focus([[data],fn])                          当元素获得焦点时，触发 focus 事件。
    $("#focusTest input").focus(function(){
        $(this).next("span").css("display","inline").fadeOut(1000);
    })

    // 5.7 focusin([data],fn)                          当元素获得焦点时，触发 focusin 事件。focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。
    $("#focusinTest p").focusin(function(){
        $(this).find("span").css("display","inline").fadeOut(1000);
    })

    // 5.8 focusout([data],fn)                         当元素失去焦点时触发 focusout 事件。focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。
    var focusoutfocus = 0, focusoutblur = 0;
    $("#focusoutTest p").focusout(function(){
        focusoutfocus++;
        $("#focusoutSp1").text("focusout fired: " + focusoutfocus + "x");//可以在父元素上检测子元素失去焦点
    })
    .blur(function(){
        focusoutblur++;
        $("#focusoutSp2").text("blur fired: " + focusoutblur + "x");//不可以在父元素上检测子元素失去焦点
    })
    $("#focusoutTest p input[type='password']").blur(function(){
        console.log("..........")
    })

    // 5.9 keydown([[data],fn])                        当键盘或按钮被按下时，发生 keydown 事件。
    var keydownTestTriggered = 0;
    $("#keydownTest input[type = 'text']").keydown(function(event){
        if(event.which == 13)
        event.preventDefault();

        keydownTestTriggered++;
        let msg = "Handler for .keydown() called " + keydownTestTriggered + " time(s).";
        console.log(msg)
        console.log(event)
    })

    // 5.12 鼠标相关事件。
    $("#mousedownTest .mousedown").mousedown(function(){
        console.log("按下鼠标")
    })
    $("#mousedownTest .mousedown").mouseup(function(){
        console.log("释放鼠标")
    })
    $("#mousedownTest .mouseenter").mouseenter(function(){
        console.log("鼠标指针移动到元素")
    })
    $("#mousedownTest .mouseenter").mouseleave(function(){
        console.log("鼠标指针离开了元素")
    })
    $("#mousedownTest .mousemove").mousemove(function(){
        console.log(event.pageX + ", " + event.pageY)
    })
    $("#mousedownTest .mouseover").mouseover(function(){
        console.log("鼠标指针移动到元素 mouseover")
    })
    $("#mousedownTest .mouseover").mouseout(function(){
        console.log("鼠标指针离开了元素 mouseout")
    })
    $("#mousedownTest .mouseover").mouseenter(function(){
        console.log("鼠标指针移动到元素 mouseenter")
    })
    $("#mousedownTest .mouseover").mouseleave(function(){
        console.log("鼠标指针离开了元素 mouseleave")
    })

    // 5.19 resize([[data],fn])                        当调整浏览器窗口的大小时，发生 resize 事件。
    $(window).resize(function(){
        console.log($(window).width() + "   " + $(window).height());
    });

    // 5.20 scroll([[data],fn])                        当用户滚动指定的元素时，会发生 scroll 事件。scroll 事件适用于所有可滚动的元素和 window 对象（浏览器窗口）。
    let scrollx = 0;
    $(window).scroll(function(){
        console.log(scrollx += 1);
    });
    
    // select([[data],fn])                        当 textarea 或文本类型的 input 元素中的文本被选择时，会发生 select 事件。
    $("#selectTest input[type=text]").select(function(){
        alert($(this).val());
    })

    // submit([[data],fn])                        当提交表单时，会发生 submit 事件。该事件只适用于表单元素。
    $("#submitTest").submit(function(){
        if ($("#submitTest input[type=text]").first().val() === "correct" ) {
            $("#submitTest span").text("Validated...").show();
            return;
        }
 
        $("#submitTest span").text("Not valid!").show().fadeOut( 1000 );
        event.preventDefault();
    })

</script>